### plotting of ga results ###

# load libraries and stuff
library("RSQLite") # write to sqlite
rm(list = ls(all = TRUE))

# establish sqlite connection
con <- dbConnect(dbDriver("SQLite"), dbname = "sqlite.db")
fri <- dbReadTable(con, "friGenetic")

# plot vol (st = 100, vi = 100, ge = 100)
png("plot_ga_vol.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], stats[,2], xlab = "GENERATIONS", ylab = "MEAN VOLUME")
dev.off()

# plot distance to Atikokan (st = 100, vi = 100, ge = 100)
png("plot_ga_atikokan.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], stats[,3] * 0.001, xlab = "GENERATIONS", ylab = "MEAN DISTANCE TO ATIKOKAN")
dev.off()

# plot distance to roads (st = 100, vi = 100, ge = 100)
png("plot_ga_roads.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], stats[,4] * 0.001, xlab = "GENERATIONS", ylab = "MEAN DISTANCE TO NEAREST ROAD")
dev.off()

# plot difference between cai and mai (st = 100, vi = 100, ge = 100)
png("plot_ga_cai.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], stats[,5], xlab = "GENERATIONS", ylab = "MEAN INCREMENT DIFFERENCE")
dev.off()

# plot all objectives (st = 100, vi = 100, ge = 100)
png("plot_ga_all_100.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], rescale(stats[,2]), xlab = "GENERATIONS", ylab = "CHANGE", type = "l", lty = 1)
lines(stats[,1], rescale(stats[,3]), lty = 2)
lines(stats[,1], rescale(stats[,4]), lty = 3)
lines(stats[,1], rescale(stats[,5]), lty = 4)
dev.off()

# plot all objectives (st = 100, vi = 100, ge = 200)
png("plot_ga_all_200.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,1), lwd = 2)
plot(stats[,1], rescale(stats[,2]), xlab = "GENERATIONS", ylab = "CHANGE", type = "l", lty = 1)
lines(stats[,1], rescale(stats[,3]), lty = 2)
lines(stats[,1], rescale(stats[,4]), lty = 3)
lines(stats[,1], rescale(stats[,5]), lty = 4)
dev.off()

# plot all objectives (different st)
png("plot_ga_st.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,3,1), oma = c(0,0,0,0), lty = 1, mfrow = c(2,2), lwd = 2)
plot(st.200.vi.100[,1], rescale(st.200.vi.100[,2]), xlab = NA, ylab = "CHANGE", type = "l", lty = 1, main = "200 SCENARIOS")
lines(st.200.vi.100[,1], rescale(st.200.vi.100[,3]), lty = 2)
lines(st.200.vi.100[,1], rescale(st.200.vi.100[,4]), lty = 3)
lines(st.200.vi.100[,1], rescale(st.200.vi.100[,5]), lty = 4)
plot(st.300.vi.100[,1], rescale(st.300.vi.100[,2]), xlab = NA, ylab = NA, type = "l", lty = 1, main = "300 SCENARIOS")
lines(st.300.vi.100[,1], rescale(st.300.vi.100[,3]), lty = 2)
lines(st.300.vi.100[,1], rescale(st.300.vi.100[,4]), lty = 3)
lines(st.300.vi.100[,1], rescale(st.300.vi.100[,5]), lty = 4)
plot(st.400.vi.100[,1], rescale(st.400.vi.100[,2]), xlab = "GENERATIONS", ylab = "CHANGE", type = "l", lty = 1, main = "400 SCENARIOS")
lines(st.400.vi.100[,1], rescale(st.400.vi.100[,3]), lty = 2)
lines(st.400.vi.100[,1], rescale(st.400.vi.100[,4]), lty = 3)
lines(st.400.vi.100[,1], rescale(st.400.vi.100[,5]), lty = 4)
plot(st.500.vi.100[,1], rescale(st.500.vi.100[,2]), xlab = "GENERATIONS", ylab = NA, type = "l", lty = 1, main = "200 SCENARIOS")
lines(st.500.vi.100[,1], rescale(st.500.vi.100[,3]), lty = 2)
lines(st.500.vi.100[,1], rescale(st.500.vi.100[,4]), lty = 3)
lines(st.500.vi.100[,1], rescale(st.500.vi.100[,5]), lty = 4)
dev.off()

# plot all objectives (different vi)
png("plot_ga_vi.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,3,1), oma = c(0,0,0,0), lty = 1, mfrow = c(2,2), lwd = 2)
plot(st.100.vi.200[,1], rescale(st.100.vi.200[,2]), xlab = NA, ylab = "CHANGE", type = "l", lty = 1, main = "100 SCENARIOS")
lines(st.100.vi.200[,1], rescale(st.100.vi.200[,3]), lty = 2)
lines(st.100.vi.200[,1], rescale(st.100.vi.200[,4]), lty = 3)
lines(st.100.vi.200[,1], rescale(st.100.vi.200[,5]), lty = 4)
plot(st.100.vi.300[,1], rescale(st.100.vi.300[,2]), xlab = NA, ylab = NA, type = "l", lty = 1, main = "200 SCENARIOS")
lines(st.100.vi.300[,1], rescale(st.100.vi.300[,3]), lty = 2)
lines(st.100.vi.300[,1], rescale(st.100.vi.300[,4]), lty = 3)
lines(st.100.vi.300[,1], rescale(st.100.vi.300[,5]), lty = 4)
plot(st.100.vi.400[,1], rescale(st.100.vi.400[,2]), xlab = "GENERATIONS", ylab = "CHANGE", type = "l", lty = 1, main = "300 SCENARIOS")
lines(st.100.vi.400[,1], rescale(st.100.vi.400[,3]), lty = 2)
lines(st.100.vi.400[,1], rescale(st.100.vi.400[,4]), lty = 3)
lines(st.100.vi.400[,1], rescale(st.100.vi.400[,5]), lty = 4)
plot(st.100.vi.500[,1], rescale(st.100.vi.500[,2]), xlab = "GENERATIONS", ylab = NA, type = "l", lty = 1, main = "400 SCENARIOS")
lines(st.100.vi.500[,1], rescale(st.100.vi.500[,3]), lty = 2)
lines(st.100.vi.500[,1], rescale(st.100.vi.500[,4]), lty = 3)
lines(st.100.vi.500[,1], rescale(st.100.vi.500[,5]), lty = 4)
dev.off()

#boxplot total volume
png("box_ga_volume.png", width = 600, height = 400)
par(font.lab = 2, font.axis = 2, family = "mono", ps = 14, mar = c(4,4,1,1), oma = c(0,0,0,0), lty = 1, mfrow = c(1,2), lwd = 2)
boxplot(v2f[[1]], xlab = "1st GENERATION", ylab = "VOLUME", outpch = NA, ylim = c(0,3000))
boxplot(v2f[[500]], xlab = "500th GENERATION", ylab = "VOLUME", outpch = NA, ylim = c(0,3000))
dev.off()


